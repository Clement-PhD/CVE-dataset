@@ -124,14 +124,16 @@ scp_v1_process(struct SCP_CONNECTION *c, struct SCP_SESSION *s)
             log_message(LOG_LEVEL_INFO, "starting Xvnc session...");
             display = session_start(s->width, s->height, s->bpp, s->username,
                                     s->password, data, SESMAN_SESSION_TYPE_XVNC,
-                                    s->domain, s->program, s->directory, s->client_ip);
+                                    s->domain, s->program, s->directory, s->client_ip,
+                                    s->guid);
         }
         else
         {
             log_message(LOG_LEVEL_INFO, "starting X11rdp session...");
             display = session_start(s->width, s->height, s->bpp, s->username,
                                     s->password, data, SESMAN_SESSION_TYPE_XRDP,
-                                    s->domain, s->program, s->directory, s->client_ip);
+                                    s->domain, s->program, s->directory, s->client_ip,
+                                    s->guid);
         }
 
         e = scp_v1s_connect_new_session(c, display);