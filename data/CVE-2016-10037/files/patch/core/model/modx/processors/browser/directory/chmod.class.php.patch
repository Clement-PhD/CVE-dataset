@@ -20,7 +20,7 @@ public function checkPermissions() {
     public function getLanguageTopics() {
         return array('file');
     }
-    
+
     public function initialize() {
         $this->setDefaultProperties(array(
             'mode' => false,
@@ -38,7 +38,9 @@ public function process() {
         $this->source->setRequestProperties($this->getProperties());
         $this->source->initialize();
 
-        $success = $this->source->chmodContainer($this->getProperty('dir'),$this->getProperty('mode'));
+        $dir = $this->getProperty('dir');
+        $dir = preg_replace('/(\.+\/)+/', '', htmlspecialchars($dir));
+        $success = $this->source->chmodContainer($dir, $this->getProperty('mode'));
 
         if (empty($success)) {
             $msg = '';
@@ -64,4 +66,4 @@ public function getSource() {
         return $this->source;
     }
 }
-return 'modBrowserFolderChmodProcessor';
\ No newline at end of file
+return 'modBrowserFolderChmodProcessor';
