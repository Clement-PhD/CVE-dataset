@@ -37,7 +37,10 @@ public function process() {
         if (!$source->checkPolicy('save')) {
             return $this->failure($this->modx->lexicon('permission_denied'));
         }
-        $success = $source->renameContainer($this->getProperty('dir'),$this->getProperty('name'));
+
+        $dir = preg_replace('/(\.+\/)+/', '', htmlspecialchars($this->getProperty('dir')));
+        $name = preg_replace('/(\.+\/)+/', '', htmlspecialchars($this->getProperty('name')));
+        $success = $source->renameContainer($dir, $name);
 
         if (!$success) {
             $msg = '';
@@ -63,4 +66,4 @@ public function validate() {
         return !$this->hasErrors();
     }
 }
-return 'modBrowserFolderUpdateProcessor';
\ No newline at end of file
+return 'modBrowserFolderUpdateProcessor';
