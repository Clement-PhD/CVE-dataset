@@ -21,10 +21,10 @@ public function getLanguageTopics() {
     public function process() {
         /* get base paths and sanitize incoming paths */
         $directory = rawurldecode($this->getProperty('directory',''));
-        $directory = ltrim(strip_tags(str_replace(array('../','./'),'',$directory)),'/');
-        
+        $directory = ltrim(strip_tags(preg_replace('/(\.+\/)+/', '', htmlspecialchars($directory))),'/');
+
         $name = $this->getProperty('name');
-        $name = ltrim(strip_tags(str_replace(array('../','./'),'',$name)),'/');
+        $name = ltrim(strip_tags(preg_replace('/(\.+\/)+/', '', htmlspecialchars($name))),'/');
 
         $loaded = $this->getSource();
         if (!($this->source instanceof modMediaSource)) {
@@ -63,4 +63,4 @@ public function getSource() {
         return $this->source->initialize();
     }
 }
-return 'modBrowserFileCreateProcessor';
\ No newline at end of file
+return 'modBrowserFileCreateProcessor';
