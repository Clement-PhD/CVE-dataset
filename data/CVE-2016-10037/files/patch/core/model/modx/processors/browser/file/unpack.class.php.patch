@@ -29,12 +29,14 @@ public function process() {
 
         $this->modx->getService('fileHandler', 'modFileHandler');
 
-        $fileobj = $this->modx->fileHandler->make($this->properties['path'] . $this->properties['file']);
+        $target = $this->properties['path'] . $this->properties['file'];
+        $target = preg_replace('/(\.+\/)+/', '', htmlspecialchars($target));
+        $fileobj = $this->modx->fileHandler->make($target);
 
         if (!$this->validate($fileobj)) {
             return $this->failure($this->modx->lexicon('file_err_unzip_invalid_path') . ': ' . $fileobj->getPath());
         }
-        
+
         // currently the archive content is extracted to the folder where the archive is stored
         if (!$fileobj->unpack($this->properties['path'] . dirname($this->properties['file']))) {
             return $this->failure($this->modx->lexicon('file_err_unzip'));
@@ -61,9 +63,9 @@ public function validate(modFileSystemResource $fileobj) {
         if (!$fileobj->exists()) {
              $this->addFieldError('path', $this->modx->lexicon('file_err_nf'));
         }
-        
+
         return !$this->hasErrors();
     }
 }
 
-return 'modUnpackProcessor';
\ No newline at end of file
+return 'modUnpackProcessor';
