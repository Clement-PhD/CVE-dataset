@@ -29,7 +29,8 @@ public function initialize() {
             'id' => '',
         ));
         $dir = $this->getProperty('id');
-        if (empty($dir) || $dir == 'root') {
+        $dir = preg_replace('/(\.+\/)+/', '', htmlspecialchars($dir));
+        if (empty($dir) || $dir === 'root') {
             $this->setProperty('id','');
         } else if (strpos($dir, 'n_') === 0) {
             $dir = substr($dir, 2);