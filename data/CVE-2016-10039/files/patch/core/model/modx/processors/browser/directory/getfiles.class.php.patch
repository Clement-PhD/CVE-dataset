@@ -30,9 +30,6 @@ public function initialize() {
         $this->setDefaultProperties(array(
             'dir' => '',
         ));
-        if ($this->getProperty('dir') == 'root') {
-            $this->setProperty('dir','');
-        }
         return true;
     }
 
@@ -51,7 +48,12 @@ public function process() {
             return $this->failure($this->modx->lexicon('permission_denied'));
         }
 
-        $list = $this->source->getObjectsInContainer($this->getProperty('dir'));
+        $dir = $this->getProperty('dir');
+        $dir = preg_replace('/(\.+\/)+/', '', htmlspecialchars($dir));
+        if ($dir === 'root') {
+            $dir = '';
+        }
+        $list = $this->source->getObjectsInContainer($dir);
         return $this->outputArray($list);
     }
 