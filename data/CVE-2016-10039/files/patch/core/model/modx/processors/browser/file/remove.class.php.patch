@@ -24,6 +24,7 @@ public function process() {
         if (empty($file)) {
             return $this->modx->error->failure($this->modx->lexicon('file_err_ns'));
         }
+        $file = preg_replace('/(\.+\/)+/', '', htmlspecialchars($file));
 
         $loaded = $this->getSource();
         if (!($this->source instanceof modMediaSource)) {