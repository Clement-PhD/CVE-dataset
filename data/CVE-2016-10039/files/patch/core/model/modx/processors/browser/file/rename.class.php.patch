@@ -21,7 +21,6 @@ public function process() {
         if (!$this->validate()) {
             return $this->failure();
         }
-        $oldFile = $this->getProperty('path');
 
         $loaded = $this->getSource();
         if (!($this->source instanceof modMediaSource)) {
@@ -31,7 +30,11 @@ public function process() {
             return $this->failure($this->modx->lexicon('permission_denied'));
         }
 
-        $success = $this->source->renameObject($oldFile,$this->getProperty('name'));
+        $oldFile = $this->getProperty('path');
+        $oldFile = preg_replace('/(\.+\/)+/', '', htmlspecialchars($oldFile));
+        $name = $this->getProperty('name');
+        $name = preg_replace('/(\.+\/)+/', '', htmlspecialchars($name));
+        $success = $this->source->renameObject($oldFile, $name);
 
         if (empty($success)) {
             $msg = '';