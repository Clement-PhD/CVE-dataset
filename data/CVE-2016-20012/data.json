{
    "url": "https://api.github.com/repos/openssh/openssh-portable/pulls/270",
    "id": 734551838,
    "node_id": "PR_kwDOAPQCoc4ryF8e",
    "html_url": "https://github.com/openssh/openssh-portable/pull/270",
    "diff_url": "https://github.com/openssh/openssh-portable/pull/270.diff",
    "patch_url": "https://github.com/openssh/openssh-portable/pull/270.patch",
    "issue_url": "https://api.github.com/repos/openssh/openssh-portable/issues/270",
    "number": 270,
    "state": "closed",
    "locked": false,
    "title": "CVE-2016-20012 - Publickey Information leak - Only allow SSH_MSG_USERAUTH_REQUEST with signature",
    "user": {
        "login": "manfred-kaiser",
        "id": 37737811,
        "node_id": "MDQ6VXNlcjM3NzM3ODEx",
        "avatar_url": "https://avatars.githubusercontent.com/u/37737811?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/manfred-kaiser",
        "html_url": "https://github.com/manfred-kaiser",
        "followers_url": "https://api.github.com/users/manfred-kaiser/followers",
        "following_url": "https://api.github.com/users/manfred-kaiser/following{/other_user}",
        "gists_url": "https://api.github.com/users/manfred-kaiser/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/manfred-kaiser/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/manfred-kaiser/subscriptions",
        "organizations_url": "https://api.github.com/users/manfred-kaiser/orgs",
        "repos_url": "https://api.github.com/users/manfred-kaiser/repos",
        "events_url": "https://api.github.com/users/manfred-kaiser/events{/privacy}",
        "received_events_url": "https://api.github.com/users/manfred-kaiser/received_events",
        "type": "User",
        "site_admin": false
    },
    "body": "CVE: https://nvd.nist.gov/vuln/detail/CVE-2016-20012\r\n\r\nThis pull request adds a new configuration option to the server to disable user enumeration when using publickey authentication.\r\n\r\nThe user enumeration was first mentioned on 6. june 2002:\r\nhttps://github.com/openssh/openssh-portable/blob/d0fffc88c8fe90c1815c6f4097bc8cbcabc0f3dd/auth2-pubkey.c#L261-L265\r\n\r\n\r\n### Publickey authentication:\r\n\r\nPublickey authentication is defined in [RFC-4252](https://datatracker.ietf.org/doc/html/rfc4252#page-8) (released January 2006)\r\n\r\nA client is allowed to ask the server, if a specific public key is known by the server. This allows the client to generate a signature only if it's necessary. If the publickey is not known, no signature must be created.\r\n\r\n> Private keys are often stored in an encrypted form at the client\r\n   host, and the user must supply a passphrase before the signature can\r\n   be generated.  Even if they are not, the signing operation involves\r\n   some expensive computation.  To avoid unnecessary processing and user\r\n   interaction, the following message is provided for querying whether\r\n   authentication using the \"publickey\" method would be acceptable.\r\n>\r\n>      byte      SSH_MSG_USERAUTH_REQUEST\r\n\r\n**This behavior allows an attacker to check if a user is allowed to login.**\r\n\r\nRFC-4252 also defines, that it's allowed to send a `SSH_MSG_USERAUTH_REQUEST` with a signature directly:\r\n\r\n>   To perform actual authentication, the client MAY then send a\r\n   signature generated using the private key.  The client MAY send the\r\n   signature directly without first verifying whether the key is\r\n   acceptable.  The signature is sent using the following packet:\r\n>\r\n>      byte      SSH_MSG_USERAUTH_REQUEST\r\n\r\n### The patch\r\n\r\nThis patch adds a new configuration option to the OpenSSH server: `PubkeyDisablePKCheck no`\r\n\r\nIf this configuration option is enbabled, the client is not able to send a `SSH_MSG_USERAUTH_REQUEST` without signature. In cases, when a client asks the server if a publickey is known, the server denies the login.\r\n\r\nA patch was also applied to the client, because the client allways asks the server if a publickey is known. Even, when the configuration option `IdentitiesOnly` is enabled.\r\n\r\nIf the client was configured with `IdentitiesOnly`, `SSH_MSG_USERAUTH_REQUEST` with a signature is directly sent to the server. This makes the OpenSSH Client compatible with the server.\r\n\r\n### Other clients\r\n\r\nI have created a patch for PuTTY, to make PuTTY compatible with the new setting: https://github.com/manfred-kaiser/putty/commit/5e33243c57aef8aa12a9c8aa0d198c66834aaaa1\r\n\r\nThis patch was sent to Simon Tatham (PuTTY developer), with a request to merge it in the next release.\r\n\r\nWinSCP, Filezille and other clients, which are based on PuTTY can use the new configuration option. So they should be compatible in the near future.\r\n\r\n",
    "created_at": "2021-09-15T13:08:46Z",
    "updated_at": "2023-07-24T08:17:02Z",
    "closed_at": "2022-04-08T16:12:29Z",
    "merged_at": null,
    "merge_commit_sha": "9bf9ee6811b02a413d713a678bb224f12bbeafa1",
    "assignee": null,
    "assignees": [],
    "requested_reviewers": [],
    "requested_teams": [],
    "labels": [],
    "milestone": null,
    "draft": true,
    "commits_url": "https://api.github.com/repos/openssh/openssh-portable/pulls/270/commits",
    "review_comments_url": "https://api.github.com/repos/openssh/openssh-portable/pulls/270/comments",
    "review_comment_url": "https://api.github.com/repos/openssh/openssh-portable/pulls/comments{/number}",
    "comments_url": "https://api.github.com/repos/openssh/openssh-portable/issues/270/comments",
    "statuses_url": "https://api.github.com/repos/openssh/openssh-portable/statuses/55f7b9f18107084ae3cefdb588aa77d022dfa31f",
    "head": {
        "label": "manfred-kaiser:master",
        "ref": "master",
        "sha": "55f7b9f18107084ae3cefdb588aa77d022dfa31f",
        "user": {
            "login": "manfred-kaiser",
            "id": 37737811,
            "node_id": "MDQ6VXNlcjM3NzM3ODEx",
            "avatar_url": "https://avatars.githubusercontent.com/u/37737811?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/manfred-kaiser",
            "html_url": "https://github.com/manfred-kaiser",
            "followers_url": "https://api.github.com/users/manfred-kaiser/followers",
            "following_url": "https://api.github.com/users/manfred-kaiser/following{/other_user}",
            "gists_url": "https://api.github.com/users/manfred-kaiser/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/manfred-kaiser/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/manfred-kaiser/subscriptions",
            "organizations_url": "https://api.github.com/users/manfred-kaiser/orgs",
            "repos_url": "https://api.github.com/users/manfred-kaiser/repos",
            "events_url": "https://api.github.com/users/manfred-kaiser/events{/privacy}",
            "received_events_url": "https://api.github.com/users/manfred-kaiser/received_events",
            "type": "User",
            "site_admin": false
        },
        "repo": null
    },
    "base": {
        "label": "openssh:master",
        "ref": "master",
        "sha": "8a7a06ee505cb833e613f74a07392e9296286c30",
        "user": {
            "login": "openssh",
            "id": 2387206,
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzODcyMDY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/2387206?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/openssh",
            "html_url": "https://github.com/openssh",
            "followers_url": "https://api.github.com/users/openssh/followers",
            "following_url": "https://api.github.com/users/openssh/following{/other_user}",
            "gists_url": "https://api.github.com/users/openssh/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/openssh/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/openssh/subscriptions",
            "organizations_url": "https://api.github.com/users/openssh/orgs",
            "repos_url": "https://api.github.com/users/openssh/repos",
            "events_url": "https://api.github.com/users/openssh/events{/privacy}",
            "received_events_url": "https://api.github.com/users/openssh/received_events",
            "type": "Organization",
            "site_admin": false
        },
        "repo": {
            "id": 15991457,
            "node_id": "MDEwOlJlcG9zaXRvcnkxNTk5MTQ1Nw==",
            "name": "openssh-portable",
            "full_name": "openssh/openssh-portable",
            "private": false,
            "owner": {
                "login": "openssh",
                "id": 2387206,
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjIzODcyMDY=",
                "avatar_url": "https://avatars.githubusercontent.com/u/2387206?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/openssh",
                "html_url": "https://github.com/openssh",
                "followers_url": "https://api.github.com/users/openssh/followers",
                "following_url": "https://api.github.com/users/openssh/following{/other_user}",
                "gists_url": "https://api.github.com/users/openssh/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/openssh/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/openssh/subscriptions",
                "organizations_url": "https://api.github.com/users/openssh/orgs",
                "repos_url": "https://api.github.com/users/openssh/repos",
                "events_url": "https://api.github.com/users/openssh/events{/privacy}",
                "received_events_url": "https://api.github.com/users/openssh/received_events",
                "type": "Organization",
                "site_admin": false
            },
            "html_url": "https://github.com/openssh/openssh-portable",
            "description": "Portable OpenSSH",
            "fork": false,
            "url": "https://api.github.com/repos/openssh/openssh-portable",
            "forks_url": "https://api.github.com/repos/openssh/openssh-portable/forks",
            "keys_url": "https://api.github.com/repos/openssh/openssh-portable/keys{/key_id}",
            "collaborators_url": "https://api.github.com/repos/openssh/openssh-portable/collaborators{/collaborator}",
            "teams_url": "https://api.github.com/repos/openssh/openssh-portable/teams",
            "hooks_url": "https://api.github.com/repos/openssh/openssh-portable/hooks",
            "issue_events_url": "https://api.github.com/repos/openssh/openssh-portable/issues/events{/number}",
            "events_url": "https://api.github.com/repos/openssh/openssh-portable/events",
            "assignees_url": "https://api.github.com/repos/openssh/openssh-portable/assignees{/user}",
            "branches_url": "https://api.github.com/repos/openssh/openssh-portable/branches{/branch}",
            "tags_url": "https://api.github.com/repos/openssh/openssh-portable/tags",
            "blobs_url": "https://api.github.com/repos/openssh/openssh-portable/git/blobs{/sha}",
            "git_tags_url": "https://api.github.com/repos/openssh/openssh-portable/git/tags{/sha}",
            "git_refs_url": "https://api.github.com/repos/openssh/openssh-portable/git/refs{/sha}",
            "trees_url": "https://api.github.com/repos/openssh/openssh-portable/git/trees{/sha}",
            "statuses_url": "https://api.github.com/repos/openssh/openssh-portable/statuses/{sha}",
            "languages_url": "https://api.github.com/repos/openssh/openssh-portable/languages",
            "stargazers_url": "https://api.github.com/repos/openssh/openssh-portable/stargazers",
            "contributors_url": "https://api.github.com/repos/openssh/openssh-portable/contributors",
            "subscribers_url": "https://api.github.com/repos/openssh/openssh-portable/subscribers",
            "subscription_url": "https://api.github.com/repos/openssh/openssh-portable/subscription",
            "commits_url": "https://api.github.com/repos/openssh/openssh-portable/commits{/sha}",
            "git_commits_url": "https://api.github.com/repos/openssh/openssh-portable/git/commits{/sha}",
            "comments_url": "https://api.github.com/repos/openssh/openssh-portable/comments{/number}",
            "issue_comment_url": "https://api.github.com/repos/openssh/openssh-portable/issues/comments{/number}",
            "contents_url": "https://api.github.com/repos/openssh/openssh-portable/contents/{+path}",
            "compare_url": "https://api.github.com/repos/openssh/openssh-portable/compare/{base}...{head}",
            "merges_url": "https://api.github.com/repos/openssh/openssh-portable/merges",
            "archive_url": "https://api.github.com/repos/openssh/openssh-portable/{archive_format}{/ref}",
            "downloads_url": "https://api.github.com/repos/openssh/openssh-portable/downloads",
            "issues_url": "https://api.github.com/repos/openssh/openssh-portable/issues{/number}",
            "pulls_url": "https://api.github.com/repos/openssh/openssh-portable/pulls{/number}",
            "milestones_url": "https://api.github.com/repos/openssh/openssh-portable/milestones{/number}",
            "notifications_url": "https://api.github.com/repos/openssh/openssh-portable/notifications{?since,all,participating}",
            "labels_url": "https://api.github.com/repos/openssh/openssh-portable/labels{/name}",
            "releases_url": "https://api.github.com/repos/openssh/openssh-portable/releases{/id}",
            "deployments_url": "https://api.github.com/repos/openssh/openssh-portable/deployments",
            "created_at": "2014-01-17T05:53:25Z",
            "updated_at": "2023-12-21T03:30:08Z",
            "pushed_at": "2023-12-19T18:17:53Z",
            "git_url": "git://github.com/openssh/openssh-portable.git",
            "ssh_url": "git@github.com:openssh/openssh-portable.git",
            "clone_url": "https://github.com/openssh/openssh-portable.git",
            "svn_url": "https://github.com/openssh/openssh-portable",
            "homepage": null,
            "size": 26958,
            "stargazers_count": 2623,
            "watchers_count": 2623,
            "language": "C",
            "has_issues": false,
            "has_projects": false,
            "has_downloads": true,
            "has_wiki": false,
            "has_pages": false,
            "has_discussions": false,
            "forks_count": 1657,
            "mirror_url": null,
            "archived": false,
            "disabled": false,
            "open_issues_count": 126,
            "license": {
                "key": "other",
                "name": "Other",
                "spdx_id": "NOASSERTION",
                "url": null,
                "node_id": "MDc6TGljZW5zZTA="
            },
            "allow_forking": true,
            "is_template": false,
            "web_commit_signoff_required": false,
            "topics": [
                "c",
                "cryptography",
                "file-sharing",
                "keychain",
                "login",
                "security"
            ],
            "visibility": "public",
            "forks": 1657,
            "open_issues": 126,
            "watchers": 2623,
            "default_branch": "master"
        }
    },
    "_links": {
        "self": {
            "href": "https://api.github.com/repos/openssh/openssh-portable/pulls/270"
        },
        "html": {
            "href": "https://github.com/openssh/openssh-portable/pull/270"
        },
        "issue": {
            "href": "https://api.github.com/repos/openssh/openssh-portable/issues/270"
        },
        "comments": {
            "href": "https://api.github.com/repos/openssh/openssh-portable/issues/270/comments"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/openssh/openssh-portable/pulls/270/comments"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/openssh/openssh-portable/pulls/comments{/number}"
        },
        "commits": {
            "href": "https://api.github.com/repos/openssh/openssh-portable/pulls/270/commits"
        },
        "statuses": {
            "href": "https://api.github.com/repos/openssh/openssh-portable/statuses/55f7b9f18107084ae3cefdb588aa77d022dfa31f"
        }
    },
    "author_association": "NONE",
    "auto_merge": null,
    "active_lock_reason": null,
    "merged": false,
    "mergeable": false,
    "rebaseable": false,
    "mergeable_state": "dirty",
    "merged_by": null,
    "comments": 24,
    "review_comments": 0,
    "maintainer_can_modify": false,
    "commits": 10,
    "additions": 45,
    "deletions": 3,
    "changed_files": 13
}