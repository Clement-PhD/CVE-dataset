@@ -1,5 +1,6 @@
 
 import base64
+import hmac
 
 
 def calculate_at_hash(access_token, hash_alg):
@@ -58,3 +59,27 @@ def timedelta_total_seconds(delta):
         delta (timedelta): A timedelta to convert to seconds.
     """
     return delta.days * 24 * 60 * 60 + delta.seconds
+
+
+def constant_time_string_compare(a, b):
+    """Helper for comparing string in constant time, independent
+    of the python version being used.
+
+    Args:
+        a (str): A string to compare
+        b (str): A string to compare
+    """
+
+    try:
+        return hmac.compare_digest(a, b)
+    except AttributeError:
+
+        if len(a) != len(b):
+            return False
+
+        result = 0
+
+        for x, y in zip(a, b):
+            result |= ord(x) ^ ord(y)
+
+        return result == 0
