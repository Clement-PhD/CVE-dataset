@@ -3,6 +3,7 @@
 import java.util.ArrayList;
 import java.util.List;
 
+import com.dotcms.repackage.org.apache.logging.log4j.util.Strings;
 import net.sourceforge.squirrel_sql.fw.preferences.BaseQueryTokenizerPreferenceBean;
 import net.sourceforge.squirrel_sql.fw.preferences.IQueryTokenizerPreferenceBean;
 import net.sourceforge.squirrel_sql.fw.sql.QueryTokenizer;
@@ -21,6 +22,11 @@
 
 public class SQLUtil {
 
+
+	private static final String[] EVIL_SQL_WORDS = { "select", "insert", "delete", "update", "replace", "create", "distinct", "like", "and ", "or ", "limit",
+			"group", "order", "as ", "count","drop", "alter","truncate", "declair", "where", "exec", "--", "procedure", "pg_", "lock",
+			"unlock","write", "engine", "null","not ","mode", "set ",";"};
+
 	public static List<String> tokenize(String schema) {
 		List<String> ret=new ArrayList<String>();
 		if (schema!=null) {
@@ -147,4 +153,49 @@ public static String addLimits(String query, long offSet, long limit) {
 		}
   	  return queryString.toString();
 	}
+	
+	/**
+	 * Method to sanitize order by SQL injection
+	 * @param parameter
+	 * @return
+	 */
+	public static String sanitizeSortBy(String parameter){
+		String[] validOrders = {"title", "modDate", "page_url","name","velocity_var_name","description","category_","sort_order","keywords"};
+
+
+		
+		if(!UtilMethods.isSet(parameter)){//check if is not null
+			return "";
+		}
+		
+		for(String str : EVIL_SQL_WORDS){
+			if(parameter.contains(str)){//check if the order by requested have any other command
+				return "";
+			}
+		}
+		
+		for(String str : validOrders){
+			if(parameter.contains(str)){//check if the order by requested is a valid one
+				return parameter;
+			}
+		}
+		
+		return "";
+	}
+
+	public static String sanitizeParameter(String parameter){
+
+
+		if(Strings.isBlank(parameter)){//check if is not null
+			return "";
+		}
+
+		for(String str : EVIL_SQL_WORDS){
+			if(parameter.contains(str)){//check if the order by requested have any other command
+				return "";
+			}
+		}
+
+		return parameter;
+	}
 }
