@@ -70,7 +70,27 @@ public function create($user_id = null)
         }
 
         if ($this->mdl_user_clients->run_validation()) {
-            $this->mdl_user_clients->save();
+            
+            if ($this->input->post('user_all_clients')) {
+                $users_id = array($user_id);
+                
+                $this->mdl_user_clients->set_all_clients_user($users_id);
+                
+                $user_update = array(
+                    'user_all_clients' => 1
+                );
+                
+            } else {
+                $user_update = array(
+                    'user_all_clients' => 0
+                );
+                
+               $this->mdl_user_clients->save(); 
+            }
+            
+            $this->db->where('user_id',$user_id);
+            $this->db->update('ip_users',$user_update);
+            
             redirect('user_clients/user/' . $user_id);
         }
 