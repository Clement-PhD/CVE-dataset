@@ -1345,6 +1345,11 @@ SdpContents::Session::Medium::parse(ParseBuffer& pb)
          pb.skipChar();
          int num = pb.integer();
 
+         if (num > 255)
+         {
+            pb.fail(__FILE__, __LINE__, "Too many connection addresses");
+         }
+
          Connection& con = mConnections.back();
          const Data& addr = con.getAddress();
          size_t i = addr.size() - 1;