@@ -20,7 +20,7 @@ $.fn.flot_pie = function(){
                     return '';
                 }else{
                     label_exists = true;
-                    return '<div class="percent">' + Math.round(100 * max.data / sum) + '%</div>' + max.label;
+                    return '<div class="percent">' + Math.round(100 * max.data / sum) + '%</div>' + _.escape(max.label);
                 }
             }
           },
@@ -39,7 +39,7 @@ $.fn.flot_pie = function(){
     });
     bind_hover_event(target, function(item){
       var percent = Math.round(item.series.percent);
-      return item.series.label + ' ('+percent+'%)';
+      return _.escape(item.series.label) + ' ('+percent+'%)';
     });
     $(target).bind("plotclick", function (event, pos, item) {
       search_on_click(event, item);
@@ -59,8 +59,8 @@ function resize_label(label){
 
 function trunc_with_tooltip(val){
   if (val.length > 10) {
-    var trunced_val = val.substring(0, 10) + "...";
-    val = '<small data-toggle="tooltip" title=' + val + '>' + trunced_val + '</small>';
+    var trunced_val = _.escape(val.substring(0, 10) + "...");
+    val = '<small data-toggle="tooltip" title="' + _.escape(val) + '">' + trunced_val + '</small>';
   }
   return val;
 }
@@ -108,7 +108,7 @@ function expanded_pie(target, data){
 
     bind_hover_event(target, function(item){
       var percent = Math.round(item.series.percent);
-      return item.series.label + ' ('+percent+'%)';
+      return _.escape(item.series.label) + ' ('+percent+'%)';
     });
   target.bind("plotclick", function (event, pos, item) {
     search_on_click(event, item);
@@ -204,7 +204,7 @@ function chart_legend_options(item){
         noColumns:4,
         container:"#legendContainer",
         labelFormatter: function(label, series) {
-          return '<a rel="twipsy" data-original-title="' + __('Details') + '" href="' + series.href + '">' + label + '</a>';
+          return '<a rel="twipsy" data-original-title="' + __('Details') + '" href="' + series.href + '">' + _.escape(label) + '</a>';
         }
       };
     case "hide":
@@ -240,7 +240,7 @@ function reset_zoom(item){
 
 function showTooltip(pos, item, formater) {
   var content = formater(item);
-  $('<div id="flot-tooltip">' + content + '</div>').css({
+  $('<div id="flot-tooltip">').text(content).css({
     top: pos.pageY - 40,
     left: pos.pageX -10,
     'border-color': item.series.color
@@ -313,7 +313,7 @@ function get_pie_chart(div, url) {
           hostsCount += this.data;
         });
         expanded_pie(target, data.values);
-        $('.modal-title').empty().append( __('Fact distribution chart') + ' - <b>' + data.name + ' </b><small> ('+ Jed.sprintf(n__("%s host", "%s hosts", hostsCount), hostsCount) +')</small>');
+        $('.modal-title').empty().append( __('Fact distribution chart') + ' - <b>' + _.escape(data.name) + ' </b><small> ('+ Jed.sprintf(n__("%s host", "%s hosts", hostsCount), hostsCount) +')</small>');
         target.attr('data-url', foreman_url("/hosts?search=facts." + data.name + "~~VAL1~"));
       });
     });
@@ -330,7 +330,7 @@ function expand_chart(ref){
   {
     var new_chart = chart.clone().empty().attr('id', modal_id + "_chart").removeClass('small');
     $('body').append('<div id="' + modal_id + '" class="modal fade"><div class="modal-dialog"><div class="modal-content"></div></div></div>');
-    $("#"+modal_id+" .modal-content").append('<div class="modal-header"><a href="#" class="close" data-dismiss="modal">&times;</a><h3> ' +chart.data('title')+ ' </h3></div>')
+    $("#"+modal_id+" .modal-content").append('<div class="modal-header"><a href="#" class="close" data-dismiss="modal">&times;</a><h3> ' +_.escape(chart.data('title'))+ ' </h3></div>')
         .append('<div class="modal-body"></div>');
     $("#"+modal_id+" .modal-body").append(new_chart);
     expanded_pie(new_chart, new_chart.data('series'));