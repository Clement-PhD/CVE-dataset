@@ -172,11 +172,11 @@ function check_search_str()
     if ($form_code_type == 'PROD') {
         $query = "SELECT dt.drug_id, dt.selector, d.name " .
         "FROM drug_templates AS dt, drugs AS d WHERE " .
-        "( d.name LIKE '%$search_term%' OR " .
-        "dt.selector LIKE '%$search_term%' ) " .
+        "( d.name LIKE ? OR " .
+        "dt.selector LIKE ? ) " .
         "AND d.drug_id = dt.drug_id " .
         "ORDER BY d.name, dt.selector, dt.drug_id";
-        $res = sqlStatement($query);
+        $res = sqlStatement($query, array('%'.$search_term.'%', '%'.$search_term.'%'));
         $row_count = 0;
         while ($row = sqlFetchArray($res)) {
             $row_count = $row_count + 1;
@@ -188,9 +188,9 @@ function check_search_str()
         }
     } else {
         $query = "SELECT count(*) as count FROM codes " .
-        "WHERE (code_text LIKE '%$search_term%' OR " .
-        "code LIKE '%$search_term%') " ;
-        $res = sqlStatement($query);
+        "WHERE (code_text LIKE ? OR " .
+        "code LIKE ?) " ;
+        $res = sqlStatement($query, array('%'.$search_term.'%', '%'.$search_term.'%'));
         if ($row = sqlFetchArray($res)) {
             $no_of_items = addslashes($row['count']);
             if ($no_of_items < 1) {
@@ -206,11 +206,11 @@ function check_search_str()
             }
 
             $query = "SELECT code_type, code, modifier, code_text FROM codes " .
-            "WHERE (code_text LIKE '%$search_term%' OR " .
-            "code LIKE '%$search_term%') " .
+            "WHERE (code_text LIKE ? OR " .
+            "code LIKE ?) " .
             "ORDER BY code";
           // echo "\n<!-- $query -->\n"; // debugging
-            $res = sqlStatement($query);
+            $res = sqlStatement($query, array('%'.$search_term.'%', '%'.$search_term.'%'));
             $row_count = 0;
             while ($row = sqlFetchArray($res)) {
                 $row_count = $row_count + 1;