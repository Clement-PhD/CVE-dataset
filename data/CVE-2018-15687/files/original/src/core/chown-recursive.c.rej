--- /dev/null
+++ /dev/null
@@ -128,5 +127,8 @@ int path_chown_recursive(const char *path, uid_t uid, gid_t gid) {
             (!gid_is_valid(gid) || st.st_gid == gid))
                 return 0;
 
-        return chown_recursive_internal(TAKE_FD(fd), &st, uid, gid); /* we donate the fd to the call, regardless if it succeeded or failed */
+        r = chown_recursive_internal(fd, &st, uid, gid);
+        fd = -1; /* we donated the fd to the call, regardless if it succeeded or failed */
+
+        return r;
 
