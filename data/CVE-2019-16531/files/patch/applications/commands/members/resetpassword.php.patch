@@ -29,18 +29,18 @@
             $_POST[$parent] = clean($child);
         }
         $token = clean($PGET->g('token'));
-        
 
 
-        NoCSRF::check('csrf_token', $_POST);
+
+        NoCSRF::check('csrf_token', $_POST, true, 60*10, true);
 
         if($_POST['password']==$_POST['a_password']){
             if($_POST['a_password']==$_POST['password']){
                 $password = encrypt($_POST['password']);
                 $MYSQL->bind('token', $token);
                 $query = $MYSQL->query("SELECT * FROM {prefix}password_reset_requests WHERE reset_token = :token");
                 $MYSQL->bind('user', $query['0']['user']);
-                $MYSQL->bind('hashpass', $password);               
+                $MYSQL->bind('hashpass', $password);
                 $resetpass = $MYSQL->query("UPDATE {prefix}users SET user_password = :hashpass WHERE id = :user");
                 if ($resetpass) {
                     $MYSQL->query("DELETE FROM {prefix}password_reset_requests WHERE user = ".$query['0']['user']."");