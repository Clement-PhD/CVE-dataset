@@ -50,11 +50,10 @@
     if ($nv_Request->get_bool('nvloginhash', 'cookie', false)) {
         $user = $nv_Request->get_string('nvloginhash', 'cookie', '');
         if (!empty($user) and $global_config['allowuserlogin']) {
-            $user = unserialize($user);
-
+            $user = json_decode($user, true);
             if (isset($user['userid']) and isset($user['checknum']) and isset($user['checkhash'])) {
                 $user['userid'] = intval($user['userid']);
-                if ($user['checkhash'] == md5($user['userid'] . $user['checknum'] . $global_config['sitekey'] . $client_info['browser']['key'])) {
+                if ($user['checkhash'] === md5($user['userid'] . $user['checknum'] . $global_config['sitekey'] . $client_info['browser']['key'])) {
                     $_sql = 'SELECT userid, group_id, username, email, first_name, last_name, gender, photo, birthday, regdate,
 						view_mail, remember, in_groups, active2step, checknum, last_agent AS current_agent, last_ip AS current_ip, last_login AS current_login,
 						last_openid AS current_openid, password, question, answer, safemode, email_verification_time