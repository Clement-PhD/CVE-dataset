@@ -57,10 +57,12 @@ class stream_engine_base_t : public io_object_t, public i_engine
   public:
     stream_engine_base_t (fd_t fd_,
                           const options_t &options_,
-                          const endpoint_uri_pair_t &endpoint_uri_pair_);
+                          const endpoint_uri_pair_t &endpoint_uri_pair_,
+                          bool has_handshake_stage_);
     ~stream_engine_base_t () ZMQ_OVERRIDE;
 
     //  i_engine interface implementation.
+    bool has_handshake_stage () ZMQ_FINAL { return _has_handshake_stage; };
     void plug (zmq::io_thread_t *io_thread_,
                zmq::session_base_t *session_) ZMQ_FINAL;
     void terminate () ZMQ_FINAL;
@@ -189,9 +191,13 @@ class stream_engine_base_t : public io_object_t, public i_engine
     //  The session this engine is attached to.
     zmq::session_base_t *_session;
 
-    // Socket
+    //  Socket
     zmq::socket_base_t *_socket;
 
+    //  Indicate if engine has an handshake stage, if it does, engine must call session.engine_ready
+    //  when handshake is completed.
+    bool _has_handshake_stage;
+
     ZMQ_NON_COPYABLE_NOR_MOVABLE (stream_engine_base_t)
 };
 }