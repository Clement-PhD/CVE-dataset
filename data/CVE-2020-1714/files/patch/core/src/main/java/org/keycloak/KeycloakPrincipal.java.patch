@@ -17,6 +17,10 @@
 
 package org.keycloak;
 
+import org.keycloak.common.util.DelegatingSerializationFilter;
+
+import java.io.IOException;
+import java.io.ObjectInputStream;
 import java.io.Serializable;
 import java.security.Principal;
 
@@ -63,4 +67,10 @@ public int hashCode() {
     public String toString() {
         return name;
     }
+
+    private void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException {
+        DelegatingSerializationFilter filter = new DelegatingSerializationFilter();
+        filter.setFilter(in, "org.keycloak.KeycloakSecurityContext;org.keycloak.KeycloakPrincipal;java.util.*;!*");
+        in.defaultReadObject();
+    }
 }
