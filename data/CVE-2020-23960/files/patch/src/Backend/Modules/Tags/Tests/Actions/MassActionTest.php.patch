@@ -24,15 +24,18 @@ protected function setUp(): void
 
     public function testAuthenticationIsNeeded(Client $client): void
     {
-        self::assertAuthenticationIsNeeded($client, '/private/en/tags/mass_action');
+        self::assertAuthenticationIsNeeded(
+            $client,
+            $this->appendCsrfTokenToUrl($client, '/private/en/tags/mass_action')
+        );
     }
 
     public function testActionIsRequired(Client $client): void
     {
         $this->login($client);
 
         $client->setMaxRedirects(1);
-        self::assertHttpStatusCode200($client, '/private/en/tags/mass_action');
+        self::assertHttpStatusCode200($client, $this->appendCsrfTokenToUrl($client, '/private/en/tags/mass_action'));
         self::assertCurrentUrlEndsWith($client, '&error=no-action-selected');
     }
 
@@ -41,7 +44,10 @@ public function testIdsAreRequired(Client $client): void
         $this->login($client);
 
         $client->setMaxRedirects(1);
-        self::assertHttpStatusCode200($client, '/private/en/tags/mass_action?action=delete');
+        self::assertHttpStatusCode200(
+            $client,
+            $this->appendCsrfTokenToUrl($client, '/private/en/tags/mass_action?action=delete')
+        );
         self::assertCurrentUrlEndsWith($client, '&error=no-selection');
     }
 
@@ -50,7 +56,10 @@ public function testDeletingOneTag(Client $client): void
         $this->login($client);
 
         $client->setMaxRedirects(1);
-        self::assertHttpStatusCode200($client, '/private/en/tags/mass_action?action=delete&id[]=2');
+        self::assertHttpStatusCode200(
+            $client,
+            $this->appendCsrfTokenToUrl($client, '/private/en/tags/mass_action?action=delete&id[]=2')
+        );
         self::assertCurrentUrlEndsWith($client, '&report=deleted');
         $response = $client->getResponse();
         self::assertResponseHasContent(
@@ -70,8 +79,11 @@ public function testDeletingAllTags(Client $client): void
         $client->setMaxRedirects(1);
         self::assertHttpStatusCode200(
             $client,
-            '/private/en/tags/mass_action?action=delete&id[]=' . LoadTagsTags::TAGS_TAG_1_ID
-            . '&id[]=' . LoadTagsTags::TAGS_TAG_2_ID
+            $this->appendCsrfTokenToUrl(
+                $client,
+                '/private/en/tags/mass_action?action=delete&id[]=' . LoadTagsTags::TAGS_TAG_1_ID
+                . '&id[]=' . LoadTagsTags::TAGS_TAG_2_ID
+            )
         );
         self::assertCurrentUrlEndsWith($client, '&report=deleted');
 