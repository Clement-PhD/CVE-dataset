@@ -38,6 +38,7 @@
 use LibreNMS\Util\Html;
 use LibreNMS\Util\StringHelpers;
 use LibreNMS\Util\Url;
+use LibreNMS\Util\Validate;
 
 class TopDevicesController extends WidgetController
 {
@@ -67,6 +68,9 @@ public function getView(Request $request)
         $settings = $this->getSettings();
         $sort = $settings['sort_order'];
 
+        // We use raw() function below, validate input and default to sane value.
+        $sort = Validate::ascDesc($sort, 'ASC');
+
         switch ($settings['top_query']) {
             case 'traffic':
                 $data = $this->getTrafficData($sort);