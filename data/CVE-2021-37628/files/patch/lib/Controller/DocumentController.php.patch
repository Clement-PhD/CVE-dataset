@@ -333,6 +333,10 @@ public function publicPage($shareToken, $fileName, $fileId) {
 				}
 			}
 
+			if (($share->getPermissions() & Constants::PERMISSION_READ) === 0) {
+				return new TemplateResponse('core', '403', [], 'guest');
+			}
+
 			$node = $share->getNode();
 			if($node instanceof Folder) {
 				$item = $node->getById($fileId)[0];
@@ -451,6 +455,10 @@ public function remote($shareToken, $remoteServer, $remoteServerToken, $filePath
 				}
 			}
 
+			if (($share->getPermissions() & Constants::PERMISSION_READ) === 0) {
+				return new TemplateResponse('core', '403', [], 'guest');
+			}
+
 			$node = $share->getNode();
 			if ($filePath !== null) {
 				$node = $node->get($filePath);