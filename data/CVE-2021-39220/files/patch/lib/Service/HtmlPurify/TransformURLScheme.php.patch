@@ -71,6 +71,11 @@ public function __construct(array $messageParameters,
 	public function filter(&$uri, $config, $context) {
 		/** @var \HTMLPurifier_Context $context */
 		/** @var \HTMLPurifier_Config $config */
+
+		if ($uri->scheme === null) {
+			$uri->scheme = 'https';
+		}
+
 		// Only HTTPS and HTTP urls should get rewritten
 		if ($uri->scheme === 'https' || $uri->scheme === 'http' || $uri->scheme === 'ftp') {
 			$uri = $this->filterHttpFtp($uri, $context);