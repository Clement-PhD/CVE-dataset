@@ -148,10 +148,6 @@ public function extAppGetData($fileId) {
 					];
 				} catch (\Exception $e) {
 					$this->logger->logException($e, ['app'=>'richdocuments']);
-					$params = [
-						'errors' => [['error' => $e->getMessage()]]
-					];
-					return new TemplateResponse('core', 'error', $params, 'guest');
 				}
 			}
 		}
@@ -252,10 +248,7 @@ public function index($fileId, $path = null) {
 			return $response;
 		} catch (\Exception $e) {
 			$this->logger->logException($e, ['app'=>'richdocuments']);
-			$params = [
-				'errors' => [['error' => $e->getMessage()]]
-			];
-			return new TemplateResponse('core', 'error', $params, 'guest');
+			return $this->renderErrorPage('Failed to open the requested file.');
 		}
 	}
 
@@ -370,10 +363,7 @@ public function publicPage($shareToken, $fileName, $fileId) {
 			}
 		} catch (\Exception $e) {
 			$this->logger->logException($e, ['app'=>'richdocuments']);
-			$params = [
-				'errors' => [['error' => $e->getMessage()]]
-			];
-			return new TemplateResponse('core', 'error', $params, 'guest');
+			return $this->renderErrorPage('Failed to open the requested file.');
 		}
 
 		return new TemplateResponse('core', '403', [], 'guest');
@@ -420,10 +410,7 @@ public function openRemoteFile($fileId) {
 			}
 		} catch (\Exception $e) {
 			$this->logger->logException($e, ['app'=>'richdocuments']);
-			$params = [
-				'errors' => [['error' => $e->getMessage()]]
-			];
-			return new TemplateResponse('core', 'error', $params, 'guest');
+			return $this->renderErrorPage('Failed to open the requested file.');
 		}
 
 		return new TemplateResponse('core', '403', [], 'guest');
@@ -505,10 +492,7 @@ public function remote($shareToken, $remoteServer, $remoteServerToken, $filePath
 			return new TemplateResponse('core', '404', [], 'guest');
 		} catch (\Exception $e) {
 			$this->logger->logException($e, ['app'=>'richdocuments']);
-			$params = [
-				'errors' => [['error' => $e->getMessage()]]
-			];
-			return new TemplateResponse('core', 'error', $params, 'guest');
+			return $this->renderErrorPage('Failed to open the requested file.');
 		}
 
 		return new TemplateResponse('core', '403', [], 'guest');
@@ -614,4 +598,11 @@ public function create($mimetype,
 			'message' => $this->l10n->t('Cannot create document')
 		]);
 	}
+
+	private function renderErrorPage($message) {
+		$params = [
+			'errors' => [['error' => $message]]
+		];
+		return new TemplateResponse('core', 'error', $params, 'guest');
+	}
 }
