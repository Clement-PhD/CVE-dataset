@@ -146,10 +146,6 @@ public function extAppGetData($fileId) {
 					];
 				} catch (\Exception $e) {
 					$this->logger->logException($e, ['app' => 'officeonline']);
-					$params = [
-						'errors' => [['error' => $e->getMessage()]]
-					];
-					return new TemplateResponse('core', 'error', $params, 'guest');
 				}
 			}
 		}
@@ -276,10 +272,7 @@ public function index($fileId, $path = null) {
 			return $response;
 		} catch (\Exception $e) {
 			$this->logger->logException($e, ['app' => 'officeonline']);
-			$params = [
-				'errors' => [['error' => $e->getMessage()]]
-			];
-			return new TemplateResponse('core', 'error', $params, 'guest');
+			return $this->renderErrorPage('Failed to open the requested file.');
 		}
 
 		return new TemplateResponse('core', '403', [], 'guest');
@@ -395,13 +388,9 @@ public function publicPage($shareToken, $fileName, $fileId) {
 			}
 		} catch (\Exception $e) {
 			$this->logger->logException($e, ['app' => 'officeonline']);
-			$params = [
-				'errors' => [['error' => $e->getMessage()]]
-			];
-			return new TemplateResponse('core', 'error', $params, 'guest');
 		}
 
-		return new TemplateResponse('core', '403', [], 'guest');
+		return $this->renderErrorPage('Failed to open the requested file.');
 	}
 
 	/**
@@ -467,10 +456,7 @@ public function remote($shareToken, $remoteServer, $remoteServerToken, $filePath
 			return new TemplateResponse('core', '404', [], 'guest');
 		} catch (\Exception $e) {
 			$this->logger->logException($e, ['app' => 'officeonline']);
-			$params = [
-				'errors' => [['error' => $e->getMessage()]]
-			];
-			return new TemplateResponse('core', 'error', $params, 'guest');
+			return $this->renderErrorPage('Failed to open the requested file.');
 		}
 
 		return new TemplateResponse('core', '403', [], 'guest');
@@ -575,4 +561,11 @@ public function create($mimetype,
 			'message' => $this->l10n->t('Can\'t create document')
 		]);
 	}
+
+	private function renderErrorPage($message) {
+		$params = [
+			'errors' => [['error' => $message]]
+		];
+		return new TemplateResponse('core', 'error', $params, 'guest');
+	}
 }
