@@ -25,6 +25,7 @@
 
 use OCA\Circles\CirclesManager;
 use OCA\DAV\CardDAV\PhotoCache;
+use OCA\Talk\Chat\ChatManager;
 use OCA\Talk\Exceptions\ParticipantNotFoundException;
 use OCA\Talk\GuestManager;
 use OCA\Talk\Model\Attendee;
@@ -396,6 +397,14 @@ public function parseMessage(Message $chatMessage): void {
 		} elseif ($message === 'object_shared') {
 			$parsedParameters['object'] = $parameters['metaData'];
 			$parsedMessage = '{object}';
+
+			if (isset($parsedParameters['object']['type'])
+				&& $parsedParameters['object']['type'] === 'geo-location'
+				&& !preg_match(ChatManager::GEO_LOCATION_VALIDATOR, $parsedParameters['object']['id'])) {
+				$parsedParameters = [];
+				$parsedMessage = $this->l->t('The shared location is malformed');
+			}
+
 			$chatMessage->setMessageType('comment');
 		} elseif ($message === 'matterbridge_config_added') {
 			$parsedMessage = $this->l->t('{actor} set up Matterbridge to synchronize this conversation with other chats');