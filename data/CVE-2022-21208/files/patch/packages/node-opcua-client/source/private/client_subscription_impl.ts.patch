@@ -33,11 +33,10 @@ import {
     ModifySubscriptionResponse
 } from "node-opcua-service-subscription";
 
-import { CallbackT, StatusCode, StatusCodes } from "node-opcua-status-code";
+import { StatusCode, StatusCodes } from "node-opcua-status-code";
 import { Callback, ErrorCallback } from "node-opcua-status-code";
 import * as utils from "node-opcua-utils";
-import { promoteOpaqueStructure } from "node-opcua-client-dynamic-extension-object";
-import { DataType, Variant } from "node-opcua-variant";
+import { promoteOpaqueStructureInNotificationData } from "node-opcua-client-dynamic-extension-object";
 import { createMonitoredItemsLimit, IBasicSession, readOperationLimits } from "node-opcua-pseudo-session";
 
 import { IBasicSessionWithSubscription } from "node-opcua-pseudo-session";
@@ -67,42 +66,6 @@ const PENDING_SUBSCRIPTION_ID = 0xc0cac01a;
 const TERMINATED_SUBSCRIPTION_ID = 0xc0cac01b;
 const TERMINATING_SUBSCRIPTION_ID = 0xc0cac01c;
 
-async function promoteOpaqueStructureInNotificationData(
-    session: IBasicSession,
-    notificationData: NotificationData[]
-): Promise<void> {
-    const dataValuesToPromote: { value: Variant }[] = [];
-    for (const notification of notificationData) {
-        if (!notification) {
-            continue;
-        }
-        if (notification instanceof DataChangeNotification) {
-            if (notification.monitoredItems) {
-                for (const monitoredItem of notification.monitoredItems) {
-                    if (monitoredItem.value.value && monitoredItem.value.value.dataType === DataType.ExtensionObject) {
-                        dataValuesToPromote.push(monitoredItem.value);
-                    }
-                }
-            }
-        } else if (notification instanceof EventNotificationList) {
-            if (notification.events) {
-                for (const events of notification.events) {
-                    if (events.eventFields) {
-                        // eslint-disable-next-line max-depth
-                        for (const eventField of events.eventFields) {
-                            // eslint-disable-next-line max-depth
-                            if (eventField.dataType === DataType.ExtensionObject) {
-                                dataValuesToPromote.push({ value: eventField });
-                            }
-                        }
-                    }
-                }
-            }
-        }
-    }
-    await promoteOpaqueStructure(session, dataValuesToPromote);
-}
-
 const minimumMaxKeepAliveCount = 3;
 
 function displayKeepAliveWarning(sessionTimeout: number, maxKeepAliveCount: number, publishingInterval: number): boolean {