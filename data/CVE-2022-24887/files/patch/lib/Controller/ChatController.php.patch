@@ -24,6 +24,7 @@
 
 namespace OCA\Talk\Controller;
 
+use OC\Security\TrustedDomainHelper;
 use OCA\Talk\Chat\AutoComplete\SearchPlugin;
 use OCA\Talk\Chat\AutoComplete\Sorter;
 use OCA\Talk\Chat\ChatManager;
@@ -109,6 +110,9 @@ class ChatController extends AEnvironmentAwareController {
 	/** @var IValidator */
 	protected $richObjectValidator;
 
+	/** @var TrustedDomainHelper */
+	protected $trustedDomainHelper;
+
 	/** @var IL10N */
 	private $l;
 
@@ -130,6 +134,7 @@ public function __construct(string $appName,
 								ITimeFactory $timeFactory,
 								IEventDispatcher $eventDispatcher,
 								IValidator $richObjectValidator,
+								TrustedDomainHelper $trustedDomainHelper,
 								IL10N $l) {
 		parent::__construct($appName, $request);
 
@@ -149,6 +154,7 @@ public function __construct(string $appName,
 		$this->timeFactory = $timeFactory;
 		$this->eventDispatcher = $eventDispatcher;
 		$this->richObjectValidator = $richObjectValidator;
+		$this->trustedDomainHelper = $trustedDomainHelper;
 		$this->l = $l;
 	}
 
@@ -285,6 +291,16 @@ public function shareObjectToChat(string $objectType, string $objectId, string $
 		$data['type'] = $objectType;
 		$data['id'] = $objectId;
 
+		if (isset($data['link'])) {
+			$parsedUrl = parse_url($data['link']);
+			$domain = $parsedUrl['host'] ?? '';
+			$domain .= isset($parsedUrl['port']) && $parsedUrl['port'] ? (':' . $parsedUrl['port']) : '';
+
+			if (!$this->trustedDomainHelper->isTrustedDomain($domain)) {
+				return new DataResponse([], Http::STATUS_BAD_REQUEST);
+			}
+		}
+
 		try {
 			$this->richObjectValidator->validate('{object}', ['object' => $data]);
 		} catch (InvalidObjectExeption $e) {