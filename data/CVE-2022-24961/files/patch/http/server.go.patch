@@ -1,6 +1,7 @@
 package http
 
 import (
+	"context"
 	"crypto/tls"
 	"log"
 	"net/http"
@@ -134,5 +135,20 @@ func (server *APIServer) StartSecured() error {
 		WriteTimeout: 30 * time.Minute,
 	}
 
+	go func() {
+		securityShutdown := config.AgentOptions.AgentSecurityShutdown
+		time.Sleep(securityShutdown)
+
+		if !server.signatureService.IsAssociated() {
+			log.Printf("[INFO] [main,http] [message: Shutting down API server as no client was associated after %s, keeping alive to prevent restart by docker/kubernetes]", securityShutdown)
+
+			err := httpServer.Shutdown(context.Background())
+			if err != nil {
+				log.Fatalf("[ERROR] [server] [message: failed shutting down server] [error: %s]", err)
+			}
+
+		}
+	}()
+
 	return httpServer.ListenAndServeTLS(agent.TLSCertPath, agent.TLSKeyPath)
 }