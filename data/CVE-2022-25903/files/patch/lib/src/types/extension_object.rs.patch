@@ -84,6 +84,8 @@ impl BinaryEncoder<ExtensionObject> for ExtensionObject {
     }
 
     fn decode<S: Read>(stream: &mut S, decoding_options: &DecodingOptions) -> EncodingResult<Self> {
+        // Extension object is depth checked to prevent deep recursion
+        let _depth_lock = decoding_options.depth_lock()?;
         let node_id = NodeId::decode(stream, decoding_options)?;
         let encoding_type = u8::decode(stream, decoding_options)?;
         let body = match encoding_type {