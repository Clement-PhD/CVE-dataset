@@ -114,8 +114,8 @@ public function handle(Event $event): void {
 		}
 
 		$circle = $event->getCircle();
-
 		$federatedEvent = $event->getFederatedEvent();
+		$hashedPasswords = $federatedEvent->getParams()->gArray('hashedPasswords');
 
 		$result = [];
 		foreach ($circle->getInheritedMembers(false, true) as $member) {
@@ -136,7 +136,12 @@ public function handle(Event $event): void {
 						throw new ShareWrapperNotFoundException();
 					}
 
-					$shareToken = $this->shareTokenService->generateShareToken($share, $member);
+					$shareToken = $this->shareTokenService->generateShareToken(
+						$share,
+						$member,
+						$this->get($member->getSingleId(), $hashedPasswords)
+					);
+
 					$share->setShareToken($shareToken);
 				} catch (Exception $e) {
 					$share = null;
@@ -149,6 +154,6 @@ public function handle(Event $event): void {
 			];
 		}
 
-		$event->getFederatedEvent()->setResultEntry('info', $result);
+		$federatedEvent->setResultEntry('info', $result);
 	}
 }