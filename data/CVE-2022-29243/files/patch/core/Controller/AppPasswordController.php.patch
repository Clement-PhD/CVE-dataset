@@ -99,6 +99,9 @@ public function getAppPassword(): DataResponse {
 		}
 
 		$userAgent = $this->request->getHeader('USER_AGENT');
+		if (mb_strlen($userAgent) > 128) {
+			$userAgent = mb_substr($userAgent, 0, 120) . 'â€¦';
+		}
 
 		$token = $this->random->generate(72, ISecureRandom::CHAR_UPPER.ISecureRandom::CHAR_LOWER.ISecureRandom::CHAR_DIGITS);
 