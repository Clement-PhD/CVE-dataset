@@ -4,6 +4,7 @@
 
 package io.ktor.util
 
+import kotlin.random.*
 import kotlin.test.*
 
 class HashFunctionTest {
@@ -14,4 +15,14 @@ class HashFunctionTest {
             hex(Sha1().digest("abc".encodeToByteArray()))
         )
     }
+
+    @Test
+    fun sha1BytesTest() {
+        val bytes = ByteArray(20) { it.toByte() }
+        val result = byteArrayOf(
+            96, 44, 99, -46, -13, -47, 60, -93, 32, 108, -33, 32, 76, -34, 36, -25, -40, -12, 38, 108
+        )
+
+        assertTrue { sha1(bytes).contentEquals(result) }
+    }
 }
