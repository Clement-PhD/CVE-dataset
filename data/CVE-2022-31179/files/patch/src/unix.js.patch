@@ -46,13 +46,14 @@ function escapeArgBash(arg, interpolation, quoted) {
   if (interpolation) {
     result = result
       .replace(/\\/g, "\\\\")
+      .replace(/\n/g, " ")
       .replace(/(^|\s)(~|#)/g, "$1\\$2")
       .replace(/(\*|\?)/g, "\\$1")
       .replace(/(\$|\;|\&|\|)/g, "\\$1")
       .replace(/(\(|\)|\<|\>)/g, "\\$1")
       .replace(/("|'|`)/g, "\\$1")
-      .replace(/\{(?=(.*?(?:\,|\.).*?)\})/g, "\\{")
-      .replace(/(?<=\=(?:.*?:)?)(~)(?=\:|\=|\-|\+|\/|0|\s|$)/g, "\\$1");
+      .replace(/\{(?=([^]*?(?:\,|\.)[^]*?)\})/g, "\\{")
+      .replace(/(?<=\=(?:[^]*?:)?)(~)(?=\:|\=|\-|\+|\/|0|\s|$)/g, "\\$1");
   } else if (quoted) {
     result = result.replace(/'/g, `'\\''`);
   }
@@ -74,12 +75,13 @@ function escapeArgDash(arg, interpolation, quoted) {
   if (interpolation) {
     result = result
       .replace(/\\/g, "\\\\")
+      .replace(/\n/g, " ")
       .replace(/(^|\s)(~|#)/g, "$1\\$2")
       .replace(/(\*|\?)/g, "\\$1")
       .replace(/(\$|\;|\&|\|)/g, "\\$1")
       .replace(/(\(|\)|\<|\>)/g, "\\$1")
       .replace(/("|'|`)/g, "\\$1")
-      .replace(/\{(?=(.*?(?:\,|\.).*?)\})/g, "\\{");
+      .replace(/\{(?=([^]*?(?:\,|\.)[^]*?)\})/g, "\\{");
   } else if (quoted) {
     result = result.replace(/'/g, `'\\''`);
   }
@@ -101,6 +103,7 @@ function escapeArgZsh(arg, interpolation, quoted) {
   if (interpolation) {
     result = result
       .replace(/\\/g, "\\\\")
+      .replace(/\n/g, " ")
       .replace(/(^|\s)(~|#|=)/g, "$1\\$2")
       .replace(/(\*|\?)/g, "\\$1")
       .replace(/(\$|\;|\&|\|)/g, "\\$1")