@@ -33,16 +33,16 @@ const binPowerShell = "powershell.exe";
  * @returns {string} The escaped argument.
  */
 function escapeArgCmd(arg, interpolation, quoted) {
-  let result = arg.replace(/\u0000/g, "").replace(/\n|\r/g, " ");
+  let result = arg.replace(/\0/gu, "").replace(/[\n\r]/gu, " ");
 
   if (interpolation) {
     result = result
-      .replace(/\^/g, "^^")
-      .replace(/(<|>)/g, "^$1")
-      .replace(/(")/g, "^$1")
-      .replace(/(\&|\|)/g, "^$1");
+      .replace(/\^/gu, "^^")
+      .replace(/([<>])/gu, "^$1")
+      .replace(/(")/gu, "^$1")
+      .replace(/([&|])/gu, "^$1");
   } else if (quoted) {
-    result = result.replace(/"/g, `""`);
+    result = result.replace(/"/gu, `""`);
   }
 
   return result;
@@ -58,21 +58,21 @@ function escapeArgCmd(arg, interpolation, quoted) {
  */
 function escapeArgPowerShell(arg, interpolation, quoted) {
   let result = arg
-    .replace(/\u0000/g, "")
-    .replace(/`/g, "``")
-    .replace(/\$/g, "`$");
+    .replace(/\0/gu, "")
+    .replace(/`/gu, "``")
+    .replace(/\$/gu, "`$$");
 
   if (interpolation) {
     result = result
-      .replace(/\n|\r/g, " ")
-      .replace(/(^|\s|\u0085)((?:\*|[1-6])?)(>)/g, "$1$2`$3")
-      .replace(/(^|\s|\u0085)(<|@|#|-|\:|\])/g, "$1`$2")
-      .replace(/(,|\;|\&|\|)/g, "`$1")
-      .replace(/(\(|\)|\{|\})/g, "`$1")
-      .replace(/('|’|‘|‛|‚)/g, "`$1")
-      .replace(/("|“|”|„)/g, "`$1");
+      .replace(/[\n\r]/gu, " ")
+      .replace(/(^|[\s\u0085])([*1-6]?)(>)/gu, "$1$2`$3")
+      .replace(/(^|[\s\u0085])([#\-:<@\]])/gu, "$1`$2")
+      .replace(/([&,;|])/gu, "`$1")
+      .replace(/([(){}])/gu, "`$1")
+      .replace(/(['‘’‚‛])/gu, "`$1")
+      .replace(/(["“”„])/gu, "`$1");
   } else if (quoted) {
-    result = result.replace(/("|“|”|„)/g, "$1$1");
+    result = result.replace(/(["“”„])/gu, "$1$1");
   }
 
   return result;