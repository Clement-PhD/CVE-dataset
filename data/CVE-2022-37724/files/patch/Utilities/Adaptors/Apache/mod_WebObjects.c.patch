@@ -271,12 +271,24 @@ int WebObjects_translate(request_rec *r) {
    WebObjects_config *wc;
    WOURLComponents url;
    WOURLError urlerr;
+   WOURLError charcheck;
 
    wc = (WebObjects_config *)ap_get_module_config(r->server->module_config, &WebObjects_module);
 
    /* WOLog(WO_DBG,"<WebObjects Apache Module> new translate: %s",r->uri); */
    if (strncmp(wc->WebObjects_alias, r->uri, strlen(wc->WebObjects_alias)) == 0) {
       url = WOURLComponents_Initializer;
+
+#ifndef __PRESERVE_UNSAFE_URLS
+      // Make sure the URL does not contain forbidden characters (0x0D or 0x0A).
+      charcheck = WOValidateInitialURL( r->uri );
+      if ( charcheck != WOURLOK ) {
+         WOLog(WO_ERR, "WebObjects_translate(): declining request due to forbidden URL characters");
+         return DECLINED;
+      }
+#endif
+
+
       urlerr = WOParseApplicationName(&url, r->uri);
       if (urlerr != WOURLOK && !((urlerr == WOURLInvalidApplicationName) && ac_authorizeAppListing(&url))) {
          /* WOLog(WO_DBG,"<WebObjects Apache Module> translate - DECLINED: %s",r->uri); */