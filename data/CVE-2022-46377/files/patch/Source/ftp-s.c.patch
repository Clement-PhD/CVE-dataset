@@ -1908,15 +1908,15 @@ static  void  FTPs_ProcessCtrlCmd (FTPs_SESSION_STRUCT  *ftp_session)
 
                  for (i = 0; i <= 3; i++) {
                      dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
-                     while ((dig == DEF_NO) && (ftp_session->CtrlCmdArgs != (CPU_CHAR *)0)) {
+                     while ((dig == DEF_NO) && (ftp_session->CtrlCmdArgs != (CPU_CHAR *)0) && (*ftp_session->CtrlCmdArgs != 0)) {
                          ftp_session->CtrlCmdArgs++;
                          dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
                      }
                      p_addr[i] = Str_ParseNbr_Int32U(ftp_session->CtrlCmdArgs, &ftp_session->CtrlCmdArgs, 10);
                  }
                  for (i = 0; i <= 1; i++) {
                      dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
-                     while ((dig == DEF_NO) && (ftp_session->CtrlCmdArgs != 0)) {
+                     while ((dig == DEF_NO) && (ftp_session->CtrlCmdArgs != 0) && (*ftp_session->CtrlCmdArgs != 0)) {
                          ftp_session->CtrlCmdArgs++;
                          dig = ASCII_IsDig(*ftp_session->CtrlCmdArgs);
                      }