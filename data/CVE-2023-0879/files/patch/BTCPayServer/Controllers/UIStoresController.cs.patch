@@ -27,6 +27,7 @@
 using BTCPayServer.Services.Wallets;
 using Microsoft.AspNetCore.Authorization;
 using Microsoft.AspNetCore.DataProtection;
+using Microsoft.AspNetCore.Http;
 using Microsoft.AspNetCore.Identity;
 using Microsoft.AspNetCore.Mvc;
 using Microsoft.AspNetCore.Mvc.Rendering;
@@ -658,29 +659,42 @@ public IActionResult GeneralSettings()
 
             if (model.LogoFile != null)
             {
-                if (model.LogoFile.ContentType.StartsWith("image/", StringComparison.InvariantCulture))
+                if (model.LogoFile.Length > 1_000_000)
                 {
-                    // delete existing image
-                    if (!string.IsNullOrEmpty(blob.LogoFileId))
-                    {
-                        await _fileService.RemoveFile(blob.LogoFileId, userId);
-                    }
-
-                    // add new image
-                    try
+                    TempData[WellKnownTempData.ErrorMessage] = "The uploaded logo file should be less than 1MB";
+                }
+                else if (!model.LogoFile.ContentType.StartsWith("image/", StringComparison.InvariantCulture))
+                {
+                    TempData[WellKnownTempData.ErrorMessage] = "The uploaded logo file needs to be an image";
+                }
+                else
+                {
+                    var formFile = await model.LogoFile.Bufferize();
+                    if (!FileTypeDetector.IsPicture(formFile.Buffer, formFile.FileName))
                     {
-                        var storedFile = await _fileService.AddFile(model.LogoFile, userId);
-                        blob.LogoFileId = storedFile.Id;
+                        TempData[WellKnownTempData.ErrorMessage] = "The uploaded logo file needs to be an image";
                     }
-                    catch (Exception e)
+                    else
                     {
-                        TempData[WellKnownTempData.ErrorMessage] = $"Could not save logo: {e.Message}";
+                        model.LogoFile = formFile;
+                        // delete existing image
+                        if (!string.IsNullOrEmpty(blob.LogoFileId))
+                        {
+                            await _fileService.RemoveFile(blob.LogoFileId, userId);
+                        }
+
+                        // add new image
+                        try
+                        {
+                            var storedFile = await _fileService.AddFile(model.LogoFile, userId);
+                            blob.LogoFileId = storedFile.Id;
+                        }
+                        catch (Exception e)
+                        {
+                            TempData[WellKnownTempData.ErrorMessage] = $"Could not save logo: {e.Message}";
+                        }
                     }
                 }
-                else
-                {
-                    TempData[WellKnownTempData.ErrorMessage] = "The uploaded logo file needs to be an image";
-                }
             }
             else if (RemoveLogoFile && !string.IsNullOrEmpty(blob.LogoFileId))
             {
@@ -691,7 +705,19 @@ public IActionResult GeneralSettings()
 
             if (model.CssFile != null)
             {
-                if (model.CssFile.ContentType.Equals("text/css", StringComparison.InvariantCulture))
+                if (model.CssFile.Length > 1_000_000)
+                {
+                    TempData[WellKnownTempData.ErrorMessage] = "The uploaded file should be less than 1MB";
+                }
+                else if (!model.CssFile.ContentType.Equals("text/css", StringComparison.InvariantCulture))
+                {
+                    TempData[WellKnownTempData.ErrorMessage] = "The uploaded file needs to be a CSS file";
+                }
+                else if (!model.CssFile.FileName.EndsWith(".css", StringComparison.OrdinalIgnoreCase))
+                {
+                    TempData[WellKnownTempData.ErrorMessage] = "The uploaded file needs to be a CSS file";
+                }
+                else
                 {
                     // delete existing CSS file
                     if (!string.IsNullOrEmpty(blob.CssFileId))
@@ -710,10 +736,6 @@ public IActionResult GeneralSettings()
                         TempData[WellKnownTempData.ErrorMessage] = $"Could not save CSS file: {e.Message}";
                     }
                 }
-                else
-                {
-                    TempData[WellKnownTempData.ErrorMessage] = "The uploaded file needs to be a CSS file";
-                }
             }
             else if (RemoveCssFile && !string.IsNullOrEmpty(blob.CssFileId))
             {