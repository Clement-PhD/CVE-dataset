@@ -1,12 +1,16 @@
 <?php
-   //Callback procedure for mercedes SoC API LP1 
-   if( $_GET["code"] ) {
-      system( "/var/www/html/openWB/modules/soc_eq/auth.py " . $_GET['state'] . " " . $_GET['code']) ;
-   }
-   else {
-      echo "<html>";
-      echo "<p>" . $_GET["error"] . "</p>";
-      echo "<p>" . $_GET["error_description"] . "</p>";
-      echo "</html>";
-   }
+	//Callback procedure for mercedes SoC API LP1 
+	if( $_GET["code"] ) {
+		$state= escapeshellarg($_GET['state']);
+		$code= escapeshellarg($_GET['code']);
+		$command = escapeshellcmd($_SERVER['DOCUMENT_ROOT'] . "/openWB/modules/soc_eq/auth.py");
+		$system_command = join(" ", [$command, $state, $code]);
+		system($system_command);
+	}
+	else {
+		echo "<html>";
+		echo "<p>" . $_GET["error"] . "</p>";
+		echo "<p>" . $_GET["error_description"] . "</p>";
+		echo "</html>";
+	}
 ?>