@@ -136,7 +136,9 @@ public boolean validate(UserIdentity user)
     {
         if (!(user.getUserPrincipal() instanceof OpenIdUserPrincipal))
             return false;
-
+        OpenIdUserPrincipal userPrincipal = (OpenIdUserPrincipal)user.getUserPrincipal();
+        if (configuration.isLogoutWhenIdTokenIsExpired() && userPrincipal.getCredentials().isExpired())
+            return false;
         return loginService == null || loginService.validate(user);
     }
 